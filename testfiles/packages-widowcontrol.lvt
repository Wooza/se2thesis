\documentclass{article}
\usepackage{expl3}
%\ExplSyntaxOn
%\bool_if:NT \sys_if_engine_luatex_p: { \usepackage{fontspec} }
%\ExplSyntaxOff
\usepackage[%
  csquotes=false,%
  booktabs=false,%
  siunitx=false,%
  minted=false,%
  listings=false,%
  selnolig=false,%
  widowcontrol=true,%
  microtype=false,%
  biblatex=false,%
  cleveref=false,%
  all=false,%
]{se2packages}
\input{regression-test}

\begin{document}

\START
\ExplSyntaxOn
\showoutput

\TEST { lua-widow-control~ loaded~ in~ LuaTeX }
  {
    \bool_if:NT \sys_if_engine_luatex_p:
      {
        \cs_if_exist:NTF \lwcsetup { \TRUE } { \ERROR }
      }
  }

\TEST { lua-widow-control~ not~ loaded~ in~ pdfTeX }
  {
    \bool_if:NF \sys_if_engine_luatex_p:
      {
        \cs_if_exist:NTF \lwcsetup { \ERROR } { \TRUE }
      }
  }

\ExplSyntaxOff
\END

\end{document}

%% vim: set ft=tex :